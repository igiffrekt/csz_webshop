---
phase: 01-infrastructure-foundation
plan: 05
type: execute
wave: 3
depends_on: ["01-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Super Admin can access all Strapi features including Settings"
    - "Store Manager can access products, orders, coupons but NOT roles/users"
    - "Content Manager can access pages, media, SEO but NOT products/orders"
  artifacts:
    - path: "strapi-admin-roles"
      provides: "Custom admin roles in Strapi database"
      contains: "Store Manager, Content Manager roles"
  key_links:
    - from: "Strapi Admin Panel"
      to: "RBAC configuration"
      via: "Settings > Administration Panel > Roles"
      pattern: "role permissions UI"
---

<objective>
Configure Strapi admin roles for Admin, Store Manager, and Content Manager

Purpose: Implement the role-based access control (RBAC) requirements (ADMN-26, ADMN-27, ADMN-28) so different admin users have appropriate permissions. This is configured through Strapi's built-in admin panel, not code.

Output: Three admin roles configured - Super Admin (default), Store Manager, Content Manager - with appropriate permissions assigned.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-infrastructure-foundation/01-RESEARCH.md
@.planning/phases/01-infrastructure-foundation/01-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Super Admin account</name>
  <files>none - database operation</files>
  <action>
Ensure Strapi is running:
```bash
pnpm dev:cms
```

Navigate to http://localhost:1337/admin in a browser.

On first visit, Strapi shows the Super Admin registration form. Create the account with:
- First name: Admin
- Last name: CSZ
- Email: admin@csz-webshop.local (or user's preferred email)
- Password: (secure password - minimum 8 characters with uppercase, lowercase, number)

After registration, you'll be logged in as the Super Admin. This account has full access to all Strapi features (satisfies ADMN-26).

Document the credentials in a secure location (not in git).
  </action>
  <verify>After login, navigate to Settings > Administration Panel > Roles - Super Admin role should exist</verify>
  <done>Super Admin account created and logged in</done>
</task>

<task type="auto">
  <name>Task 2: Create Store Manager role</name>
  <files>none - database operation via Strapi UI</files>
  <action>
In Strapi admin panel, navigate to:
Settings > Administration Panel > Roles

Click "Add new role" button.

Configure Store Manager role:
- Name: Store Manager
- Description: Manages products, orders, and coupons for the webshop

Permissions to ENABLE (check the boxes):
- Collection types (when they exist - Phase 2+):
  - Product: Create, Read, Update, Delete
  - Category: Create, Read, Update, Delete
  - Order: Read, Update (not create/delete - orders come from customers)
  - Coupon: Create, Read, Update, Delete
- Plugins > Media Library: Full access (for product images)
- Plugins > Upload: Full access

Permissions to DISABLE (leave unchecked):
- Settings > Administration Panel > Roles (cannot manage roles)
- Settings > Administration Panel > Users (cannot manage admin users)
- Single types related to content pages (About, Contact, etc.)

Click "Save" to create the role.

Note: Some collection types (Product, Category, etc.) don't exist yet - they'll be created in Phase 2. The role will be updated then to grant specific permissions.
  </action>
  <verify>Store Manager role appears in the roles list with correct name and description</verify>
  <done>Store Manager role created with appropriate permission structure (ADMN-27)</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Create Content Manager role and verify all roles</name>
  <what-built>
Created three admin roles in Strapi:
1. Super Admin (default) - full access to all features
2. Store Manager - access to products, orders, coupons (not roles/users)
3. Content Manager - access to pages, media, SEO (not products/orders)
  </what-built>
  <how-to-verify>
1. Navigate to Settings > Administration Panel > Roles
2. Verify three roles exist: Super Admin, Store Manager, Content Manager
3. Click on Store Manager - verify NO access to "Settings > Administration Panel"
4. Click on Content Manager - verify NO access to "Settings > Administration Panel"

Create Content Manager role if not done:
- Name: Content Manager
- Description: Manages pages, media, and SEO content
- Enable: Media Library, Upload
- Disable: Administration Panel settings, Product/Order-related types

5. Create test users for each role:
   - Settings > Administration Panel > Users > Add new user
   - Create one Store Manager user and one Content Manager user
   - Log out and log in as each to verify access restrictions

Expected behavior:
- Store Manager cannot see Settings > Administration Panel > Roles
- Content Manager cannot see Settings > Administration Panel > Roles
- Both can access Media Library
  </how-to-verify>
  <resume-signal>Type "approved" after verifying roles work correctly, or describe any issues encountered</resume-signal>
</task>

</tasks>

<verification>
1. Super Admin exists and can access all features
2. Settings > Administration Panel > Roles shows 3+ roles
3. Store Manager role exists with products/orders/coupons focus
4. Content Manager role exists with pages/media/SEO focus
5. Neither Store Manager nor Content Manager can access role management
6. Test users can log in with restricted access
</verification>

<success_criteria>
- ADMN-26: Super Admin has full access to all Strapi features
- ADMN-27: Store Manager role exists (permissions will be refined in Phase 2 when content types are created)
- ADMN-28: Content Manager role exists (permissions will be refined in Phase 9 when content pages are created)
- Role-based access control is working
- Test users demonstrate permission restrictions
</success_criteria>

<output>
After completion, create `.planning/phases/01-infrastructure-foundation/01-05-SUMMARY.md`
</output>
