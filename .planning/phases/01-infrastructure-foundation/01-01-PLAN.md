---
phase: 01-infrastructure-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - pnpm-workspace.yaml
  - .gitignore
  - .env.example
autonomous: true

must_haves:
  truths:
    - "pnpm install works from repo root"
    - "Workspace packages can reference each other"
    - "Git ignores node_modules and env files"
  artifacts:
    - path: "package.json"
      provides: "Root package.json with workspace scripts"
      contains: "packageManager"
    - path: "pnpm-workspace.yaml"
      provides: "Workspace configuration for apps and packages"
      contains: "apps/*"
    - path: ".gitignore"
      provides: "Git ignore patterns for Node.js monorepo"
      contains: "node_modules"
  key_links:
    - from: "package.json"
      to: "pnpm-workspace.yaml"
      via: "pnpm workspace resolution"
      pattern: "packageManager.*pnpm"
---

<objective>
Initialize pnpm monorepo structure with workspace configuration

Purpose: Establish the foundational project structure that all subsequent apps (CMS, API, Web) will be installed into. This is the prerequisite for all other Phase 1 work.

Output: Working pnpm monorepo with apps/ and packages/ directories ready to receive Strapi, Fastify, and shared packages.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-infrastructure-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create monorepo root structure</name>
  <files>package.json, pnpm-workspace.yaml</files>
  <action>
Create the root package.json with:
- name: "csz-webshop"
- private: true
- packageManager: "pnpm@9.15.0"
- scripts for running apps: dev:cms, dev:api, dev (parallel), build

Create pnpm-workspace.yaml with:
```yaml
packages:
  - "apps/*"
  - "packages/*"
```

Create directory structure:
- apps/ (will hold cms, api, web)
- packages/ (will hold shared types, config)
- docker/ (will hold docker-compose.yml)
  </action>
  <verify>Run `pnpm install` from root - should complete without errors (will show "No packages to install" which is expected)</verify>
  <done>package.json exists with packageManager field, pnpm-workspace.yaml exists with apps/* and packages/*, directories created</done>
</task>

<task type="auto">
  <name>Task 2: Create .gitignore and .env.example</name>
  <files>.gitignore, .env.example</files>
  <action>
Create .gitignore with comprehensive patterns for:
- node_modules/
- .env (but NOT .env.example)
- dist/, build/, .next/
- *.log files
- .DS_Store
- IDE files (.idea/, .vscode/ except settings)
- Strapi-specific: .tmp/, .cache/, build/
- Coverage and test artifacts

Create .env.example as a template with:
- Database credentials (placeholder values)
- API ports
- Security keys (placeholder markers like "generate-random-key")
- Comments explaining each variable
  </action>
  <verify>Run `git status` - .gitignore should be tracked, no .env file should be listed if it existed</verify>
  <done>.gitignore prevents node_modules and .env from being tracked, .env.example provides template for developers</done>
</task>

<task type="auto">
  <name>Task 3: Create shared packages placeholder</name>
  <files>packages/types/package.json, packages/types/src/index.ts</files>
  <action>
Create packages/types/ as the shared TypeScript types package:

packages/types/package.json:
```json
{
  "name": "@csz/types",
  "version": "0.0.1",
  "private": true,
  "type": "module",
  "main": "./src/index.ts",
  "types": "./src/index.ts",
  "exports": {
    ".": "./src/index.ts"
  }
}
```

packages/types/src/index.ts:
```typescript
// Shared TypeScript types for CSZ Webshop
// Types will be added as needed by cms, api, and web apps

export {};
```

This establishes the pattern for shared packages that can be imported across apps.
  </action>
  <verify>Run `pnpm install` from root - should recognize workspace package @csz/types</verify>
  <done>@csz/types package exists and is recognized by pnpm workspace</done>
</task>

</tasks>

<verification>
1. `pnpm install` completes without errors
2. Directory structure exists: apps/, packages/, docker/
3. `cat pnpm-workspace.yaml` shows correct workspace config
4. `cat package.json` shows packageManager field
5. @csz/types is listed as workspace package
</verification>

<success_criteria>
- Monorepo root is initialized with pnpm 9.x
- Workspace configuration recognizes apps/* and packages/*
- Git ignores node_modules, .env, and build artifacts
- Shared types package placeholder exists
- Ready to install Strapi and Fastify apps
</success_criteria>

<output>
After completion, create `.planning/phases/01-infrastructure-foundation/01-01-SUMMARY.md`
</output>
