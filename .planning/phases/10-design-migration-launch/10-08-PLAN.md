---
phase: 10-design-migration-launch
plan: 08
type: implement
wave: 4
depends_on: [10-02, 10-03, 10-04, 10-05, 10-06, 10-07]
files_modified:
  - apps/web/src/app/[locale]/page.tsx
autonomous: true

must_haves:
  truths:
    - "Home page assembled with all sections"
    - "Data fetching for products and categories"
  artifacts:
    - apps/web/src/app/[locale]/page.tsx (redesigned)
---

<objective>
Assemble all home page sections into complete redesigned home page.

Purpose: Combine all new components into the home page.

Output: Complete home page matching reference design.
</objective>

<tasks>

<task type="auto">
  <name>Task 1: Redesign home page</name>
  <files>
    apps/web/src/app/[locale]/page.tsx
  </files>
  <action>
Completely redesign home page with all new sections:

```tsx
import { Suspense } from 'react';
import { getTranslations } from 'next-intl/server';
import type { Metadata } from 'next';

import { HeroBanner } from '@/components/home/HeroBanner';
import { TrustBadges } from '@/components/home/TrustBadges';
import { CategoryGrid } from '@/components/home/CategoryGrid';
import { ProductCollections } from '@/components/home/ProductCollections';
import { DealsSection } from '@/components/home/DealsSection';
import { PromoBanners } from '@/components/home/PromoBanners';
import { BlogSection } from '@/components/home/BlogSection';
import { FAQSection } from '@/components/home/FAQSection';
import { InstagramSection } from '@/components/home/InstagramSection';
import { ProductGridSkeleton } from '@/components/product/ProductCardSkeleton';

import { getCategories, getProducts, getFeaturedProducts } from '@/lib/api';
import { getFAQs } from '@/lib/content-api';

export async function generateMetadata(): Promise<Metadata> {
  const t = await getTranslations('home');

  return {
    title: 'CSZ Tűzvédelem - Professzionális tűzvédelmi megoldások',
    description: 'Minőségi tűzoltó készülékek, tűzjelző rendszerek és biztonsági felszerelések. CE tanúsított termékek azonnali szállítással.',
    openGraph: {
      title: 'CSZ Tűzvédelem - Professzionális tűzvédelmi megoldások',
      description: 'Minőségi tűzoltó készülékek, tűzjelző rendszerek és biztonsági felszerelések.',
      type: 'website',
    },
  };
}

export default async function HomePage() {
  // Fetch data in parallel
  const [categoriesResult, productsResult, featuredResult, faqsResult] = await Promise.allSettled([
    getCategories(),
    getProducts({ limit: 12 }),
    getFeaturedProducts(8),
    getFAQs(),
  ]);

  const categories = categoriesResult.status === 'fulfilled' ? categoriesResult.value : [];
  const products = productsResult.status === 'fulfilled' ? productsResult.value : [];
  const featuredProducts = featuredResult.status === 'fulfilled' ? featuredResult.value : [];
  const faqs = faqsResult.status === 'fulfilled' ? faqsResult.value : [];

  // Get sale products for deals section
  const saleProducts = products.filter(
    (p) => p.compareAtPrice && p.compareAtPrice > p.basePrice
  );

  return (
    <>
      {/* Hero Banner */}
      <HeroBanner />

      {/* Trust Badges */}
      <TrustBadges />

      {/* Category Grid */}
      <Suspense fallback={<div className="section bg-white" />}>
        <CategoryGrid categories={categories} />
      </Suspense>

      {/* Product Collections */}
      <Suspense fallback={
        <section className="section bg-secondary-50">
          <div className="container mx-auto px-4">
            <ProductGridSkeleton count={8} />
          </div>
        </section>
      }>
        <ProductCollections
          products={products}
          featuredProducts={featuredProducts}
        />
      </Suspense>

      {/* Deals of the Day */}
      {saleProducts.length > 0 && (
        <DealsSection products={saleProducts} />
      )}

      {/* Promotional Banners */}
      <PromoBanners />

      {/* Blog Section */}
      <BlogSection />

      {/* FAQ Section */}
      {faqs.length > 0 && (
        <section className="section bg-white">
          <div className="container mx-auto px-4">
            <div className="section-header">
              <span className="text-primary-500 font-medium text-sm uppercase tracking-wide">
                GYIK
              </span>
              <h2 className="section-title">Gyakran Ismételt Kérdések</h2>
            </div>
            <div className="max-w-3xl mx-auto">
              {/* Reuse existing FAQ accordion */}
              <FAQAccordionWrapper faqs={faqs.slice(0, 5)} />
            </div>
          </div>
        </section>
      )}

      {/* Instagram Section */}
      <InstagramSection />
    </>
  );
}

// Client wrapper for FAQ accordion (imports client component)
import { FAQAccordion } from '@/components/faq';

function FAQAccordionWrapper({ faqs }: { faqs: any[] }) {
  return <FAQAccordion faqs={faqs} />;
}
```

Note: May need to create FAQSection component if not using FAQAccordion directly, or adjust imports.
  </action>
  <verify>
    - All sections render
    - Data fetched correctly
    - Suspense boundaries work
  </verify>
  <done>Home page assembled</done>
</task>

<task type="auto">
  <name>Task 2: Create FAQSection wrapper if needed</name>
  <files>
    apps/web/src/components/home/FAQSection.tsx
  </files>
  <action>
Create home page FAQ section wrapper if needed:

```tsx
import { FAQAccordion } from '@/components/faq';

interface FAQ {
  id: number;
  documentId: string;
  question: string;
  answer: string;
  order: number;
  category?: string;
}

interface FAQSectionProps {
  faqs: FAQ[];
}

export function FAQSection({ faqs }: FAQSectionProps) {
  if (faqs.length === 0) return null;

  return (
    <section className="section bg-white">
      <div className="container mx-auto px-4">
        <div className="section-header">
          <span className="text-primary-500 font-medium text-sm uppercase tracking-wide">
            GYIK
          </span>
          <h2 className="section-title">Kérdése van? Nézze meg itt.</h2>
        </div>
        <div className="max-w-3xl mx-auto">
          <FAQAccordion faqs={faqs.slice(0, 5)} />
        </div>
      </div>
    </section>
  );
}
```
  </action>
  <verify>
    - FAQ section renders accordion
  </verify>
  <done>FAQSection created</done>
</task>

<task type="auto">
  <name>Task 3: Update home exports</name>
  <files>
    apps/web/src/components/home/index.ts
  </files>
  <action>
Ensure all home components are exported:

```typescript
export { HeroBanner } from './HeroBanner';
export { TrustBadges } from './TrustBadges';
export { CategoryGrid } from './CategoryGrid';
export { ProductCollections } from './ProductCollections';
export { DealsSection } from './DealsSection';
export { PromoBanners } from './PromoBanners';
export { BlogSection } from './BlogSection';
export { FAQSection } from './FAQSection';
export { InstagramSection } from './InstagramSection';
```
  </action>
  <verify>
    - All exports present
  </verify>
  <done>Exports updated</done>
</task>

<task type="auto">
  <name>Task 4: Build verification</name>
  <files>
    -
  </files>
  <action>
Run build to verify home page compiles:

```bash
pnpm --filter @csz/web build
```
  </action>
  <verify>
    - Build succeeds
    - No TypeScript errors
  </verify>
  <done>Build verified</done>
</task>

</tasks>

<verification>
- Home page loads with all sections
- Data fetching works
- Responsive layout
</verification>

<success_criteria>
- Complete home page matching reference design
- All sections functional
</success_criteria>
