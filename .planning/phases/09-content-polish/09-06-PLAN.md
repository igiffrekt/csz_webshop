---
phase: 09-content-polish
plan: 06
type: execute
wave: 3
depends_on: [09-02]
files_modified:
  - apps/web/src/components/animations/ScrollReveal.tsx
  - apps/web/src/components/animations/AnimatedHero.tsx
  - apps/web/src/components/animations/index.ts
  - apps/web/src/app/globals.css
autonomous: true

must_haves:
  truths:
    - "Scroll reveal animations work"
    - "Hero section has scroll-driven animation"
    - "Animations respect reduced-motion"
  artifacts:
    - path: "apps/web/src/components/animations/ScrollReveal.tsx"
      provides: "Scroll reveal component"
      contains: "ScrollReveal"
---

<objective>
Add scroll animations and section reveals.

Purpose: ANIM-01 (animated hero), ANIM-02 (section reveals), ANIM-08 (reduced-motion).

Output: Animated scroll effects with accessibility support.
</objective>

<tasks>

<task type="auto">
  <name>Task 1: Add reduced-motion CSS</name>
  <files>
    apps/web/src/app/globals.css
  </files>
  <action>
Add reduced-motion support to `apps/web/src/app/globals.css` (at the end):

```css
/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Scroll reveal animations */
.scroll-reveal {
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}

.scroll-reveal.revealed {
  opacity: 1;
  transform: translateY(0);
}

.scroll-reveal-left {
  opacity: 0;
  transform: translateX(-20px);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}

.scroll-reveal-left.revealed {
  opacity: 1;
  transform: translateX(0);
}

.scroll-reveal-right {
  opacity: 0;
  transform: translateX(20px);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}

.scroll-reveal-right.revealed {
  opacity: 1;
  transform: translateX(0);
}

.scroll-reveal-scale {
  opacity: 0;
  transform: scale(0.95);
  transition: opacity 0.6s ease-out, transform 0.6s ease-out;
}

.scroll-reveal-scale.revealed {
  opacity: 1;
  transform: scale(1);
}
```
  </action>
  <verify>
    - Reduced motion disables animations
    - Scroll reveal classes defined
    - Multiple animation variants
  </verify>
  <done>Reduced motion CSS added</done>
</task>

<task type="auto">
  <name>Task 2: Create ScrollReveal component</name>
  <files>
    apps/web/src/components/animations/ScrollReveal.tsx
    apps/web/src/components/animations/index.ts
  </files>
  <action>
Create directory and scroll reveal component at `apps/web/src/components/animations/ScrollReveal.tsx`:

```typescript
'use client';

import { useEffect, useRef, useState } from 'react';
import { cn } from '@/lib/utils';

type AnimationVariant = 'up' | 'left' | 'right' | 'scale';

interface ScrollRevealProps {
  children: React.ReactNode;
  className?: string;
  variant?: AnimationVariant;
  delay?: number;
  threshold?: number;
}

const variantClasses: Record<AnimationVariant, string> = {
  up: 'scroll-reveal',
  left: 'scroll-reveal-left',
  right: 'scroll-reveal-right',
  scale: 'scroll-reveal-scale',
};

export function ScrollReveal({
  children,
  className,
  variant = 'up',
  delay = 0,
  threshold = 0.1,
}: ScrollRevealProps) {
  const ref = useRef<HTMLDivElement>(null);
  const [isRevealed, setIsRevealed] = useState(false);

  useEffect(() => {
    // Check for reduced motion preference
    const prefersReducedMotion = window.matchMedia(
      '(prefers-reduced-motion: reduce)'
    ).matches;

    if (prefersReducedMotion) {
      setIsRevealed(true);
      return;
    }

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            setTimeout(() => {
              setIsRevealed(true);
            }, delay);
            observer.unobserve(entry.target);
          }
        });
      },
      { threshold }
    );

    if (ref.current) {
      observer.observe(ref.current);
    }

    return () => observer.disconnect();
  }, [delay, threshold]);

  return (
    <div
      ref={ref}
      className={cn(
        variantClasses[variant],
        isRevealed && 'revealed',
        className
      )}
    >
      {children}
    </div>
  );
}
```

Create index file at `apps/web/src/components/animations/index.ts`:

```typescript
export { ScrollReveal } from './ScrollReveal';
export { AnimatedHero } from './AnimatedHero';
```
  </action>
  <verify>
    - Intersection Observer triggers reveal
    - Delay option works
    - Reduced motion respected
    - Multiple variants available
  </verify>
  <done>ScrollReveal component created</done>
</task>

<task type="auto">
  <name>Task 3: Create AnimatedHero component</name>
  <files>
    apps/web/src/components/animations/AnimatedHero.tsx
  </files>
  <action>
Create animated hero at `apps/web/src/components/animations/AnimatedHero.tsx`:

```typescript
'use client';

import { useEffect, useState, useRef } from 'react';
import { cn } from '@/lib/utils';

interface AnimatedHeroProps {
  children: React.ReactNode;
  className?: string;
  backgroundImage?: string;
}

export function AnimatedHero({
  children,
  className,
  backgroundImage,
}: AnimatedHeroProps) {
  const ref = useRef<HTMLDivElement>(null);
  const [scrollY, setScrollY] = useState(0);
  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);

  useEffect(() => {
    // Check for reduced motion preference
    const motionQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
    setPrefersReducedMotion(motionQuery.matches);

    const handleMotionChange = (e: MediaQueryListEvent) => {
      setPrefersReducedMotion(e.matches);
    };

    motionQuery.addEventListener('change', handleMotionChange);

    if (!motionQuery.matches) {
      const handleScroll = () => {
        if (ref.current) {
          const rect = ref.current.getBoundingClientRect();
          if (rect.bottom > 0) {
            setScrollY(window.scrollY);
          }
        }
      };

      window.addEventListener('scroll', handleScroll, { passive: true });
      return () => {
        window.removeEventListener('scroll', handleScroll);
        motionQuery.removeEventListener('change', handleMotionChange);
      };
    }

    return () => {
      motionQuery.removeEventListener('change', handleMotionChange);
    };
  }, []);

  // Calculate parallax and fade effects
  const opacity = prefersReducedMotion ? 1 : Math.max(0, 1 - scrollY / 500);
  const translateY = prefersReducedMotion ? 0 : scrollY * 0.3;
  const scale = prefersReducedMotion ? 1 : 1 + scrollY * 0.0005;

  return (
    <div
      ref={ref}
      className={cn('relative overflow-hidden', className)}
    >
      {/* Background with parallax */}
      {backgroundImage && (
        <div
          className="absolute inset-0 bg-cover bg-center"
          style={{
            backgroundImage: `url(${backgroundImage})`,
            transform: `scale(${scale})`,
            transition: prefersReducedMotion ? 'none' : 'transform 0.1s ease-out',
          }}
        />
      )}

      {/* Overlay gradient */}
      <div className="absolute inset-0 bg-gradient-to-b from-black/50 to-black/70" />

      {/* Content with fade and translate */}
      <div
        className="relative z-10"
        style={{
          opacity,
          transform: `translateY(${translateY}px)`,
          transition: prefersReducedMotion ? 'none' : 'transform 0.1s ease-out, opacity 0.1s ease-out',
        }}
      >
        {children}
      </div>
    </div>
  );
}
```
  </action>
  <verify>
    - Parallax effect on scroll
    - Content fades on scroll
    - Reduced motion disables effects
    - Smooth performance
  </verify>
  <done>AnimatedHero component created</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. ScrollReveal animates sections on scroll
2. AnimatedHero has parallax effect
3. prefers-reduced-motion disables animations
4. Animations are smooth and non-blocking

Requirements completed:
- ANIM-01: Home page animated hero section
- ANIM-02: Section reveals on scroll
- ANIM-08: Animations respect reduced-motion
</verification>

<success_criteria>
- Scroll reveal triggers at threshold
- Hero parallax effect works
- Reduced motion users see no animation
- Performance is smooth (60fps)
</success_criteria>
