---
phase: 09-content-polish
plan: 08
type: execute
wave: 4
depends_on: [09-06]
files_modified:
  - apps/web/src/components/ui/skeleton.tsx
  - apps/web/src/components/products/ProductCardSkeleton.tsx
  - apps/web/src/components/skeletons/index.ts
  - apps/web/src/app/[locale]/layout.tsx
autonomous: true

must_haves:
  truths:
    - "Skeleton components exist"
    - "Product card has skeleton variant"
    - "Shimmer animation on skeletons"
    - "Page transitions are smooth"
  artifacts:
    - path: "apps/web/src/components/ui/skeleton.tsx"
      provides: "Skeleton component"
      contains: "skeleton"
---

<objective>
Add skeleton loading states and page transitions.

Purpose: ANIM-07 (skeleton/shimmer), ANIM-03 (page transitions), ANIM-09 (non-blocking).

Output: Loading states and smooth navigation.
</objective>

<tasks>

<task type="auto">
  <name>Task 1: Create Skeleton component</name>
  <files>
    apps/web/src/components/ui/skeleton.tsx
  </files>
  <action>
Create skeleton component at `apps/web/src/components/ui/skeleton.tsx`:

```typescript
import { cn } from "@/lib/utils";

function Skeleton({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      className={cn(
        "animate-pulse rounded-md bg-primary/10",
        "relative overflow-hidden",
        "before:absolute before:inset-0",
        "before:-translate-x-full",
        "before:animate-[shimmer_2s_infinite]",
        "before:bg-gradient-to-r",
        "before:from-transparent before:via-white/20 before:to-transparent",
        className
      )}
      {...props}
    />
  );
}

export { Skeleton };
```

Add shimmer keyframe to `apps/web/src/app/globals.css`:

```css
/* Skeleton shimmer animation */
@keyframes shimmer {
  100% {
    transform: translateX(100%);
  }
}
```
  </action>
  <verify>
    - Skeleton has pulse animation
    - Shimmer effect overlaid
    - Customizable via className
  </verify>
  <done>Skeleton component created</done>
</task>

<task type="auto">
  <name>Task 2: Create product card skeleton</name>
  <files>
    apps/web/src/components/products/ProductCardSkeleton.tsx
  </files>
  <action>
Create product card skeleton at `apps/web/src/components/products/ProductCardSkeleton.tsx`:

```typescript
import { Skeleton } from '@/components/ui/skeleton';

export function ProductCardSkeleton() {
  return (
    <div className="rounded-lg border bg-card overflow-hidden">
      {/* Image skeleton */}
      <Skeleton className="aspect-square w-full" />

      {/* Content skeleton */}
      <div className="p-4 space-y-3">
        {/* Title */}
        <Skeleton className="h-5 w-3/4" />

        {/* Category */}
        <Skeleton className="h-4 w-1/2" />

        {/* Price */}
        <div className="flex items-center gap-2">
          <Skeleton className="h-6 w-20" />
          <Skeleton className="h-4 w-16" />
        </div>

        {/* Button */}
        <Skeleton className="h-10 w-full" />
      </div>
    </div>
  );
}

export function ProductGridSkeleton({ count = 8 }: { count?: number }) {
  return (
    <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
      {Array.from({ length: count }).map((_, i) => (
        <ProductCardSkeleton key={i} />
      ))}
    </div>
  );
}
```

Update exports in `apps/web/src/components/products/index.ts`:

```typescript
export { ProductCardSkeleton, ProductGridSkeleton } from './ProductCardSkeleton';
```
  </action>
  <verify>
    - Card skeleton matches real card layout
    - Grid skeleton for loading states
    - Shimmer animation visible
  </verify>
  <done>Product card skeleton created</done>
</task>

<task type="auto">
  <name>Task 3: Create additional skeletons</name>
  <files>
    apps/web/src/components/skeletons/index.ts
    apps/web/src/components/skeletons/PageSkeleton.tsx
  </files>
  <action>
Create common skeletons at `apps/web/src/components/skeletons/PageSkeleton.tsx`:

```typescript
import { Skeleton } from '@/components/ui/skeleton';

export function PageHeaderSkeleton() {
  return (
    <div className="space-y-4 mb-8">
      <Skeleton className="h-10 w-64" />
      <Skeleton className="h-5 w-96" />
    </div>
  );
}

export function ProductDetailSkeleton() {
  return (
    <div className="container mx-auto px-4 py-8">
      <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
        {/* Image gallery skeleton */}
        <div className="space-y-4">
          <Skeleton className="aspect-square w-full rounded-lg" />
          <div className="flex gap-2">
            {[1, 2, 3, 4].map((i) => (
              <Skeleton key={i} className="w-20 h-20 rounded" />
            ))}
          </div>
        </div>

        {/* Product info skeleton */}
        <div className="space-y-4">
          <Skeleton className="h-8 w-3/4" />
          <Skeleton className="h-6 w-1/4" />
          <Skeleton className="h-10 w-32" />
          <div className="space-y-2">
            <Skeleton className="h-4 w-full" />
            <Skeleton className="h-4 w-full" />
            <Skeleton className="h-4 w-2/3" />
          </div>
          <Skeleton className="h-12 w-full" />
        </div>
      </div>
    </div>
  );
}

export function TableSkeleton({ rows = 5 }: { rows?: number }) {
  return (
    <div className="space-y-3">
      {/* Header */}
      <div className="flex gap-4 pb-2 border-b">
        <Skeleton className="h-4 w-32" />
        <Skeleton className="h-4 w-24" />
        <Skeleton className="h-4 w-20" />
        <Skeleton className="h-4 w-28" />
      </div>
      {/* Rows */}
      {Array.from({ length: rows }).map((_, i) => (
        <div key={i} className="flex gap-4 py-2">
          <Skeleton className="h-4 w-32" />
          <Skeleton className="h-4 w-24" />
          <Skeleton className="h-4 w-20" />
          <Skeleton className="h-4 w-28" />
        </div>
      ))}
    </div>
  );
}
```

Create index at `apps/web/src/components/skeletons/index.ts`:

```typescript
export { PageHeaderSkeleton, ProductDetailSkeleton, TableSkeleton } from './PageSkeleton';
```
  </action>
  <verify>
    - Page header skeleton available
    - Product detail skeleton available
    - Table skeleton for lists
  </verify>
  <done>Additional skeletons created</done>
</task>

<task type="auto">
  <name>Task 4: Add page transition styles</name>
  <files>
    apps/web/src/app/globals.css
  </files>
  <action>
Add page transition CSS to `apps/web/src/app/globals.css`:

```css
/* Page transitions */
@view-transition {
  navigation: auto;
}

::view-transition-old(root) {
  animation: fade-out 0.2s ease-out;
}

::view-transition-new(root) {
  animation: fade-in 0.2s ease-in;
}

@keyframes fade-out {
  from { opacity: 1; }
  to { opacity: 0; }
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Non-blocking animations */
.animate-non-blocking {
  animation-fill-mode: forwards;
  will-change: transform, opacity;
}
```

Note: View Transitions API support in Next.js may require experimental config. The CSS is progressive enhancement - browsers without support will ignore it.
  </action>
  <verify>
    - View transition CSS defined
    - Fade in/out animations
    - Non-blocking animation utilities
  </verify>
  <done>Page transition styles added</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Skeleton component with shimmer effect
2. Product card skeleton matches layout
3. Page transitions work in supported browsers
4. Animations don't block interactions

Requirements completed:
- ANIM-03: Smooth page transitions
- ANIM-07: Skeleton/shimmer loading states
- ANIM-09: Animations don't block actions
</verification>

<success_criteria>
- Skeletons show shimmer animation
- Product grid skeleton usable
- Page transitions smooth
- All animations non-blocking
</success_criteria>
